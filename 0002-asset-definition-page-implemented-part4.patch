From 73c0fff35658b86c08a1992659ab48517b3a9e3e Mon Sep 17 00:00:00 2001
From: sonaligupta <sonaligupta847@gmail.com>
Date: Thu, 21 Nov 2013 14:55:21 +0530
Subject: [PATCH 2/2] asset definition page implemented part4

---
 llamrei/grails-app/i18n/messages.properties     |    1 +
 llamrei/grails-app/views/stateModel/_states.gsp |   28 +++++++++++++++++------
 llamrei/grails-app/views/stateModel/edit.gsp    |   12 ++++++++++
 3 files changed, 34 insertions(+), 7 deletions(-)

diff --git a/llamrei/grails-app/i18n/messages.properties b/llamrei/grails-app/i18n/messages.properties
index 767c2f7..7fd2d78 100644
--- a/llamrei/grails-app/i18n/messages.properties
+++ b/llamrei/grails-app/i18n/messages.properties
@@ -73,6 +73,7 @@ title.state.description=Description
 title.state.stateRules=State Rule
 button.add.state=Add State
 button.add.state.delete=Delete State
+button.add.stateRule.delete=Delete State rule
 button.add.state.rule=Add State Rule
 title.stateRule.ruleType=Rule Type
 title.stateRule.ruleValue=Rule Value
diff --git a/llamrei/grails-app/views/stateModel/_states.gsp b/llamrei/grails-app/views/stateModel/_states.gsp
index bc2c5b6..f7f9bc4 100644
--- a/llamrei/grails-app/views/stateModel/_states.gsp
+++ b/llamrei/grails-app/views/stateModel/_states.gsp
@@ -4,7 +4,7 @@
         <tr class="ui-widget-header">
         <th width="150px"><g:message code="title.state.name"/></th>
         <th width="150px"><g:message code="title.state.description"/></th>
-        <th width="150px"><g:message code="title.state.stateRules"/></th>
+        <th ><g:message code="title.state.stateRules"/></th>
         <th></th>
         </thead>
         <tbody>
@@ -15,14 +15,28 @@
                 <td>${state.description}</td>
 
                 <td>
+                    <table>
+                        <th>State Rile Id</th>
+                        <th>Rule Type</th>
+                        <th>Rule Value</th>
+                        <th>Time Series</th>
+                        <th></th>
                         <g:each in="${state.stateRules}" var="stateRule">
-                             <ul>
-                                 State Rule ${stateRule.id} :
-                                 <li>Rule Type : ${stateRule.ruleType}</li>
-                                 <li>Rule Value :  ${stateRule.ruleValue1}</li>
-                                 <li>Time Series : ${stateRule.timeSeriesId}</li>
-                             </ul>
+                            <tr id="stateRule-${stateRule.id}">
+                                <td> ${stateRule.id}</td>
+                                <td> ${stateRule.ruleType}</td>
+                                <td>${stateRule.ruleValue1}</td>
+                                <td>${stateRule.timeSeriesId}</td>
+                                <td>
+                                    <a onclick="deleteStateRule('${stateRule.id}')"class="actionButton" style="display:inline">
+                                        <span><g:message code="button.add.stateRule.delete"/>
+                                        </span>
+                                    </a>
+                                </td>
+                            </tr>
                         </g:each>
+
+                    </table>
                 </td>
                              <td>
                                   <a onclick="deleteState('${state.id}')"class="actionButton" style="display:inline">
diff --git a/llamrei/grails-app/views/stateModel/edit.gsp b/llamrei/grails-app/views/stateModel/edit.gsp
index 77e5503..388ddf1 100644
--- a/llamrei/grails-app/views/stateModel/edit.gsp
+++ b/llamrei/grails-app/views/stateModel/edit.gsp
@@ -159,6 +159,18 @@
                }
          });
     }
+    function deleteStateRule(id){
+        alert("You are about to delete a state rule");
+        $.ajax({
+            type: 'POST',
+            url: '${createLink(controller: 'stateModel', action: 'deleteStateRule')}',
+            data: {stateRuleId:id},
+            success: function(data) {
+                $('tr#stateRule-'+id).remove();
+            }
+        });
+    }
+
     var srIndex = 0;
     function showStateRulesForm(){
         $('#stateRuleForm').toggle();
-- 
1.7.10.msysgit.1

